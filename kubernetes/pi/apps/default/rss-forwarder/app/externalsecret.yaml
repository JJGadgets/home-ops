---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: rss-forwarder
spec:
  target:
    deletionPolicy: Delete
    template:
      engineVersion: v2
      type: Opaque
      data:
        config.toml: |-
            [feeds.github-template]
            url = "https://github.com/onedr0p/flux-cluster-template/commits/main/.atom"
            interval = "10m"
            retry_limit = 5
            sink.type = "discord"
            sink.url = "{{ .INFRA_DISCORD_WEBHOOK }}"
            [feeds.leadedsolder]
            url = "https://www.leadedsolder.com/feed.xml"
            interval = "10m"
            retry_limit = 5
            sink.type = "discord"
            sink.url = "{{ .MM_DISCORD_WEBHOOK }}"
            [feeds.sss]
            url = "https://seatsafetyswitch.com/rss"
            interval = "10m"
            retry_limit = 5
            sink.type = "discord"
            sink.url = "{{ .MM_DISCORD_WEBHOOK }}"
            [feeds.carsmakeyoustupid]
            url = "https://carsmakeyoustupid.tumblr.com/rss"
            interval = "10m"
            retry_limit = 5
            sink.type = "discord"
            sink.url = "{{ .MM_DISCORD_WEBHOOK }}"
  refreshInterval: 1h
  data:
    - secretKey: INFRA_DISCORD_WEBHOOK
      sourceRef:
        storeRef:
          name: bitwarden-fields
          kind: ClusterSecretStore
      remoteRef:
        key: 01af241c-b129-4560-877a-ac6e00f706e3
        property: INFRA_DISCORD_WEBHOOK
    - secretKey: MM_DISCORD_WEBHOOK
      sourceRef:
        storeRef:
          name: bitwarden-fields
          kind: ClusterSecretStore
      remoteRef:
        key: 01af241c-b129-4560-877a-ac6e00f706e3
        property: MM_DISCORD_WEBHOOK
